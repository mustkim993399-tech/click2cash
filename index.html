<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Click 2 Cash Pro - Final Build</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans Bengali', sans-serif; }
        body { background: #f8fafc; color: #1e293b; min-height: 100vh; user-select: none; }
        .glass-card { background: white; border-radius: 20px; border: 1px solid #e2e8f0; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .btn-primary { background: linear-gradient(135deg, #0284c7, #0ea5e9); color: white; border-radius: 12px; padding: 14px; font-weight: bold; width: 100%; cursor: pointer; border: none; }
        .btn-disabled { background: #cbd5e1 !important; color: #64748b !important; cursor: not-allowed; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #e2e8f0; z-index: 100; }
        .content-section { display: none; }
        .content-section.active { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        #floating-timer { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.9); color: #0ea5e9; padding: 10px 25px; border-radius: 30px; font-weight: bold; z-index: 9999; display: none; border: 2px solid #0ea5e9; box-shadow: 0 0 20px rgba(14, 165, 233, 0.4); }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .animate-marquee { display: inline-block; animation: marquee 15s linear infinite; }
    </style>
</head>
<body class="pb-24">

    <div id="floating-timer">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®: <span id="timer-sec">0</span>s</div>

    <div id="auth-section" class="flex justify-center items-center min-h-screen p-6">
        <div class="glass-card w-full max-w-sm p-8 text-center border-t-4 border-sky-500">
            <h2 class="text-2xl font-bold mb-6 text-sky-700 italic">Login</h2>
            <div id="login-form">
                <input type="email" id="login-email" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="w-full p-4 mb-4 rounded-xl border outline-none focus:ring-2 ring-sky-300">
                <input type="password" id="login-password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" class="w-full p-4 mb-6 rounded-xl border outline-none focus:ring-2 ring-sky-300">
                <button onclick="login()" class="btn-primary">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <p class="mt-4 text-sm">‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞? <button onclick="toggleAuth()" class="text-sky-700 font-bold">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞</button></p>
            </div>
            <div id="register-form" class="hidden">
                <input type="text" id="reg-name" placeholder="‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ" class="w-full p-4 mb-4 rounded-xl border outline-none">
                <input type="email" id="reg-email" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤" class="w-full p-4 mb-4 rounded-xl border outline-none">
                <input type="password" id="reg-password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡ß¨+)" class="w-full p-4 mb-4 rounded-xl border outline-none">
                <input type="text" id="reg-refer" placeholder="‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)" class="w-full p-4 mb-6 rounded-xl border outline-none bg-blue-50">
                <button onclick="register()" class="btn-primary">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®</button>
                <p class="mt-4 text-sm">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? <button onclick="toggleAuth()" class="text-sky-700 font-bold">‡¶≤‡¶ó‡¶á‡¶®</button></p>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <header class="p-5 flex justify-between items-center bg-white border-b sticky top-0 z-50">
            <div>
                <h1 class="text-xl font-bold text-sky-900 italic">Click2Cash</h1>
                <p id="vpn-status-text" class="text-[10px] font-bold text-red-500 uppercase">‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ö‡ßá‡¶ï ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
            </div>
            <div class="bg-sky-700 text-white px-5 py-2 rounded-2xl shadow-md text-center">
                <p class="text-[9px] uppercase opacity-70">‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
                <p class="text-lg font-bold">‡ß≥<span id="top-balance">0.00</span></p>
            </div>
        </header>

        <div class="bg-sky-800 text-white py-2 overflow-hidden whitespace-nowrap">
            <div class="inline-block animate-marquee px-4 text-[11px] font-bold">
                ‚ö†Ô∏è ‡¶®‡¶ø‡ßü‡¶Æ: ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶®‡¶æ ‡¶π‡¶ì‡ßü‡¶æ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶Ü‡¶∏‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§ ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶≤‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§ ‚ö†Ô∏è
            </div>
        </div>

        <main class="p-4 max-w-md mx-auto">
            <section id="home" class="content-section active">
                <div class="glass-card bg-yellow-50 border-yellow-200 border-2 p-4 mb-6">
                    <h4 class="text-xs font-bold text-yellow-800 mb-1"><i class="fas fa-bell"></i> ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂:</h4>
                    <p id="admin-notice-text" class="text-[11px] text-yellow-900 leading-relaxed font-semibold italic">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                </div>

                <div class="glass-card bg-gradient-to-r from-indigo-700 to-sky-600 p-5 text-white mb-6 shadow-xl relative overflow-hidden">
                    <div class="relative z-10">
                        <h3 class="font-bold text-sm mb-1">‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶á‡¶®‡¶≠‡¶æ‡¶á‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®!</h3>
                        <p class="text-[10px] opacity-80 mb-3">‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡ß≥‡ß´.‡ß¶‡ß¶ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏‡•§</p>
                        <div class="bg-white/20 p-2 rounded-lg flex justify-between items-center border border-white/30">
                            <span id="my-refer-code" class="font-mono font-bold tracking-widest text-sm">-----</span>
                            <button onclick="copyRefer()" class="text-[10px] bg-white text-sky-700 px-4 py-1.5 rounded-md font-bold shadow-sm">COPY</button>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-4 mb-6 flex justify-between items-center border-l-8 border-emerald-500">
                    <div>
                        <h4 class="font-bold text-sm text-gray-800">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</h4>
                        <p class="text-[10px] text-gray-500">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡ß≥‡ßß.‡ß¶‡ß¶ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    </div>
                    <button id="daily-btn" onclick="collectDailyBonus()" class="bg-emerald-600 text-white px-5 py-2.5 rounded-xl text-xs font-bold shadow-lg">Collect</button>
                </div>

                <div id="tasks-container" class="space-y-4"></div>
            </section>

            <section id="wallet" class="content-section">
                <div class="glass-card p-8 mt-5 border-t-4 border-sky-600">
                    <h2 class="text-xl font-bold text-center text-sky-800 mb-6">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ (‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ßß‡ß®‡ß¶‡ß¶)</h2>
                    <input type="number" id="wd-amount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£" class="w-full p-4 mb-4 border rounded-xl bg-gray-50 outline-none">
                    <select id="wd-method" class="w-full p-4 mb-4 border rounded-xl font-bold bg-gray-50">
                        <option value="bKash">bKash (‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂)</option>
                        <option value="Nagad">Nagad (‡¶®‡¶ó‡¶¶)</option>
                    </select>
                    <input type="text" id="wd-number" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" class="w-full p-4 mb-6 border rounded-xl bg-gray-50 outline-none">
                    <button onclick="withdrawRequest()" class="btn-primary">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                </div>
            </section>
        </main>

        <nav class="bottom-nav">
            <button onclick="switchSection('home')" class="nav-item text-sky-600 text-center"><i class="fas fa-home text-xl"></i><br><span class="text-[10px] font-bold">‡¶π‡ßã‡¶Æ</span></button>
            <button onclick="switchSection('wallet')" class="nav-item text-gray-400 text-center"><i class="fas fa-wallet text-xl"></i><br><span class="text-[10px] font-bold">‡¶ì‡ßü‡¶æ‡¶≤‡ßá‡¶ü</span></button>
        </nav>
    </div>

    <script>
        // ‡ßß. ‡¶´‡¶æ‡ßü‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
        const firebaseConfig = {
            apiKey: "AIzaSyDI0riYoW-av6_5Pad-4MC0M48rncVJF7I",
            authDomain: "earnpro-e1fe4.firebaseapp.com",
            projectId: "earnpro-e1fe4",
            storageBucket: "earnpro-e1fe4.appspot.com",
            messagingSenderId: "439718395191",
            appId: "1:439718395191:web:f315a459bd9ebf3552aeb2"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth(), db = firebase.firestore();
        let userData = null, isVPN = false;

        // ‡ß®. ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ö‡ßá‡¶ï
        async function checkVPN() {
            try {
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();
                isVPN = ['US', 'GB', 'CA', 'DE'].includes(data.country_code);
                const st = document.getElementById('vpn-status-text');
                st.innerText = isVPN ? "‚úÖ VPN: Connected ("+data.country_code+")" : "‚ùå VPN: Connect USA/UK";
                st.style.color = isVPN ? "#059669" : "#dc2626";
            } catch(e) {}
        }
        checkVPN(); setInterval(checkVPN, 12000);

        // ‡ß©. ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ì ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶≤‡ßã‡¶°
        auth.onAuthStateChanged(user => {
            if(user) {
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                
                // ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶≤‡ßã‡¶°
                db.collection('settings').doc('app_config').onSnapshot(doc => {
                    if(doc.exists) {
                        document.getElementById('admin-notice-text').innerText = doc.data().admin_note;
                    } else {
                        document.getElementById('admin-notice-text').innerText = "‡¶Ü‡¶™‡¶æ‡¶§‡¶§ ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶®‡ßá‡¶á‡•§";
                    }
                });

                // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
                db.collection('users').doc(user.uid).onSnapshot(doc => {
                    userData = doc.data();
                    document.getElementById('top-balance').innerText = userData.balance.toFixed(2);
                    document.getElementById('my-refer-code').innerText = userData.uid.substring(0, 6).toUpperCase();
                    
                    const today = new Date().toDateString();
                    if(userData.lastBonus === today) {
                        const dBtn = document.getElementById('daily-btn');
                        dBtn.innerText = "Collected";
                        dBtn.disabled = true;
                        dBtn.className = "bg-gray-200 text-gray-400 px-5 py-2.5 rounded-xl text-xs font-bold";
                    }
                    loadTasks();
                });
            }
        });

        // ‡ß™. ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ì ‡¶¨‡ßã‡¶®‡¶æ‡¶∏
        async function collectDailyBonus() {
            const today = new Date().toDateString();
            if(userData.lastBonus === today) return;
            await db.collection('users').doc(userData.uid).update({
                balance: firebase.firestore.FieldValue.increment(1.00),
                lastBonus: today
            });
            alert("‡¶∏‡¶´‡¶≤! ‡ßß.‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®‡•§");
        }

        function loadTasks() {
            db.collection('tasks').onSnapshot(snap => {
                const container = document.getElementById('tasks-container');
                container.innerHTML = "";
                snap.forEach(doc => {
                    const t = doc.data();
                    const taskId = doc.id;
                    const completed = (userData.completed_tasks && userData.completed_tasks[taskId]) || 0;
                    const limit = t.limit || 10;
                    const isLimitOver = completed >= limit;

                    container.innerHTML += `
                        <div class="glass-card p-5 border-l-8 ${t.type === 'vpn' ? 'border-sky-500' : 'border-emerald-500'}">
                            <div class="flex justify-between items-start mb-2">
                                <h4 class="font-bold text-gray-800 text-sm">üöÄ ${t.name}</h4>
                                <span class="text-[9px] font-bold bg-gray-100 px-2 py-1 rounded">Daily: ${completed}/${limit}</span>
                            </div>
                            <p class="text-[11px] text-gray-500 mb-4">‡ß≥${t.reward.toFixed(2)} | ‡¶∏‡¶Æ‡ßü: ${t.timer}s | ${t.type.toUpperCase()}</p>
                            <button id="btn-${taskId}" onclick="runTask('${taskId}', '${t.link}', ${t.reward}, '${t.type}', ${t.timer})" 
                                class="btn-primary text-xs ${isLimitOver ? 'btn-disabled' : ''}" ${isLimitOver ? 'disabled' : ''}>
                                ${isLimitOver ? '‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑' : '‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®'}
                            </button>
                        </div>`;
                });
            });
        }

        // ‡ß´. ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ì ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ (Adsterra & Monetag Protection)
        function runTask(id, link, reward, type, timer) {
            if(type === 'vpn' && !isVPN) return alert("‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá USA/UK VPN ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®!");
            if(type === 'normal' && isVPN) return alert("‡¶è‡¶á ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶ü‡¶ø ‡¶ï‡¶∞‡¶§‡ßá VPN ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®!");

            const btn = document.getElementById('btn-'+id);
            const floatingTimer = document.getElementById('floating-timer');
            const timerSec = document.getElementById('timer-sec');
            
            window.open(link, '_blank');
            btn.disabled = true;
            floatingTimer.style.display = "block";
            
            let timeRemaining = timer;
            timerSec.innerText = timeRemaining;

            const interval = setInterval(() => {
                if (!document.hidden) {
                    btn.innerText = "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®!";
                    btn.style.background = "#dc2626";
                } else {
                    timeRemaining--;
                    timerSec.innerText = timeRemaining;
                    btn.innerText = "‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®: " + timeRemaining + "s";
                    btn.style.background = "linear-gradient(135deg, #0284c7, #0ea5e9)";
                }

                if (timeRemaining <= 0) {
                    clearInterval(interval);
                    floatingTimer.style.display = "none";
                    completeTask(id, reward);
                }
            }, 1000);
        }

        async function completeTask(taskId, reward) {
            const taskKey = `completed_tasks.${taskId}`;
            await db.collection('users').doc(userData.uid).update({
                balance: firebase.firestore.FieldValue.increment(reward),
                [taskKey]: firebase.firestore.FieldValue.increment(1)
            });
            alert("‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        }

        // ‡ß¨. ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ì ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø
        async function withdrawRequest() {
            const amt = parseFloat(document.getElementById('wd-amount').value);
            const num = document.getElementById('wd-number').value;
            if(amt < 1200) return alert("‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ßß‡ß®‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá!");
            if(amt > userData.balance) return alert("‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶®‡ßü!");

            await db.collection('withdrawals').add({
                uid: userData.uid, name: userData.name, amount: amt, method: document.getElementById('wd-method').value,
                number: num, status: 'pending', date: new Date().toISOString()
            });
            await db.collection('users').doc(userData.uid).update({ balance: firebase.firestore.FieldValue.increment(-amt) });
            alert("‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        }

        function copyRefer() {
            const code = document.getElementById('my-refer-code').innerText;
            navigator.clipboard.writeText(code).then(() => alert("‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!"));
        }

        function switchSection(id) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.replace('text-sky-600', 'text-gray-400'));
            event.currentTarget.classList.replace('text-gray-400', 'text-sky-600');
        }

        function toggleAuth() {
            document.getElementById('login-form').classList.toggle('hidden');
            document.getElementById('register-form').classList.toggle('hidden');
        }

        async function login() {
            const e = document.getElementById('login-email').value, p = document.getElementById('login-password').value;
            try { await auth.signInWithEmailAndPassword(e, p); } catch(e) { alert("‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
        }

        async function register() {
            const n = document.getElementById('reg-name').value, e = document.getElementById('reg-email').value, p = document.getElementById('reg-password').value, r = document.getElementById('reg-refer').value;
            if(!n || p.length < 6) return alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶® (‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)");
            try {
                const res = await auth.createUserWithEmailAndPassword(e, p);
                const uid = res.user.uid;
                await db.collection('users').doc(uid).set({ uid, name: n, email: e, balance: 0, completed_tasks: {}, lastBonus: "" });
                
                if(r) {
                    const usersRef = db.collection('users');
                    const snapshot = await usersRef.get();
                    snapshot.forEach(async doc => {
                        if(doc.id.substring(0, 6).toUpperCase() === r.toUpperCase()) {
                            await usersRef.doc(doc.id).update({
                                balance: firebase.firestore.FieldValue.increment(5.00)
                            });
                        }
                    });
                }
                alert("‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            } catch(e) { alert(e.message); }
        }
    </script>
</body>
</html>        }

        async function completeTask(taskId, reward) {
            const taskKey = `completed_tasks.${taskId}`;
            await db.collection('users').doc(userData.uid).update({
                balance: firebase.firestore.FieldValue.increment(reward),
                [taskKey]: firebase.firestore.FieldValue.increment(1)
            });
            alert("‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        }

        // ‡ß¨. ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ì ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø
        async function withdrawRequest() {
            const amt = parseFloat(document.getElementById('wd-amount').value);
            const num = document.getElementById('wd-number').value;
            if(amt < 1200) return alert("‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ßß‡ß®‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá!");
            if(amt > userData.balance) return alert("‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶®‡ßü!");

            await db.collection('withdrawals').add({
                uid: userData.uid, name: userData.name, amount: amt, method: document.getElementById('wd-method').value,
                number: num, status: 'pending', date: new Date().toISOString()
            });
            await db.collection('users').doc(userData.uid).update({ balance: firebase.firestore.FieldValue.increment(-amt) });
            alert("‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        }

        function copyRefer() {
            const code = document.getElementById('my-refer-code').innerText;
            navigator.clipboard.writeText(code).then(() => alert("‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!"));
        }

        function switchSection(id) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.replace('text-sky-600', 'text-gray-400'));
            event.currentTarget.classList.replace('text-gray-400', 'text-sky-600');
        }

        function toggleAuth() {
            document.getElementById('login-form').classList.toggle('hidden');
            document.getElementById('register-form').classList.toggle('hidden');
        }

        async function login() {
            const e = document.getElementById('login-email').value, p = document.getElementById('login-password').value;
            try { await auth.signInWithEmailAndPassword(e, p); } catch(e) { alert("‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
        }

        async function register() {
            const n = document.getElementById('reg-name').value, e = document.getElementById('reg-email').value, p = document.getElementById('reg-password').value, r = document.getElementById('reg-refer').value;
            if(!n || p.length < 6) return alert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶® (‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)");
            try {
                const res = await auth.createUserWithEmailAndPassword(e, p);
                const uid = res.user.uid;
                await db.collection('users').doc(uid).set({ uid, name: n, email: e, balance: 0, completed_tasks: {}, lastBonus: "" });
                
                if(r) {
                    const usersRef = db.collection('users');
                    const snapshot = await usersRef.get();
                    snapshot.forEach(async doc => {
                        if(doc.id.substring(0, 6).toUpperCase() === r.toUpperCase()) {
                            await usersRef.doc(doc.id).update({
                                balance: firebase.firestore.FieldValue.increment(5.00)
                            });
                        }
                    });
                }
                alert("‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
            } catch(e) { alert(e.message); }
        }
    </script>
</body>
                            </html>
